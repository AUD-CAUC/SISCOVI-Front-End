<br>
<div class="row">
    <div class="input-field col l7 offset-l2">
        <select id="selecao_contrato" materialize="material_select" [materializeSelectOptions]="contratos" (change)="defineCodigoContrato($event.target.value)">
            <option disabled>Selecione um Contrato</option>
            <option *ngFor="let contrato of contratos" [value]="contrato.codigo" [selected]="codigoContrato == contrato.codigo">{{contrato.nomeDaEmpresa}} - Contrato nº: {{contrato.numeroDoContrato}}</option>
        </select>
        <label for="selecao_contrato">Contrato<span class="red-text"> *</span></label>
    </div>
</div>
<div class="container" *ngIf="!totais && codigoContrato">
    <div class="row" >
        <div class="col s12 grey lighten-4" style="margin-top: 1em">
            <br>
            <h5 class="center-align">Nada pendente aqui ! <i class="small material-icons">mood</i></h5>
        </div>
    </div>
</div>
<div class="row" *ngIf="codigoContrato && totais">
    <form [formGroup]="totalMensalForm">
        <div class="col xl12 l12 s12 l12 m12" formArrayName="avaliacaoDeCalculo">
            <table class="highlight centered responsive-table hoverable">
                <thead>
                <tr>
                    <th>
                        <input type="checkbox" id="test5" (change)="isSelected = !isSelected"/>
                        <label for="test5"></label>
                    </th>
                    <th *ngIf="config.user.perfil.sigla == 'USUÁRIO'">Status</th>
                    <th *ngIf="config.user.perfil.sigla == 'ADMINISTRADOR'">Avaliação</th>
                    <th>Data Referência</th>
                    <th>Cálculos</th>
                </tr>
                </thead>
                <tbody>
                <tr *ngFor="let total of totais; let i = index">
                    <td>
                        <div [formGroupName]="i">
                            <input type="checkbox" [checked]="isSelected" [ngModel]="isSelected" formControlName="selected" id="{{i}}"/>
                            <label for="{{i}}"></label>
                        </div>
                    </td>
                    <td *ngIf="config.user.perfil.sigla == 'USUÁRIO'">{{total.status}} </td>
                    <td *ngIf="config.user.perfil.sigla == 'ADMINISTRADOR'">
                        <div [formGroupName]="i">
                            <div class="row">
                                <div class="input-field col s12">
                                    <select materialize="material_select" formControlName="avaliacao">
                                        <option value="EXECUTADO">EXECUTAR</option>
                                        <option value="REJEITADO">REJEITAR</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                    </td>
                    <td>{{total.totaisMensais.dataReferencia | date: 'shortDate'}}</td>
                    <td>
                        <table class="highlight centered responsive-table">
                            <thead>
                            <tr>
                                <th>Função</th>
                                <th>Férias</th>
                                <th>Terço Constitucional</th>
                                <th>Décimo Terceiro</th>
                                <th>Incidência Retido</th>
                                <th>Multa do FGTS</th>
                                <th class="black-text">Total</th>
                            </tr>
                            </thead>
                            <tbody>
                            <tr *ngFor="let calculo of total.totaisMensais.totais">
                                <td>{{calculo.funcao }}</td>
                                <td>{{calculo.ferias | currency:'BRL':true:'1.2-2'}}</td>
                                <td>{{calculo.tercoConstitucional | currency:'BRL':true:'1.2-2'}}</td>
                                <td>{{calculo.decimoTerceiro | currency:'BRL':true:'1.2-2'}}</td>
                                <td>{{calculo.incidencia | currency:'BRL':true:'1.2-2'}}</td>
                                <td>{{calculo.multaFGTS | currency:'BRL':true:'1.2-2'}}</td>
                                <td class="black-text text-darken-2">{{calculo.total | currency:'BRL':true:'1.2-2'}}</td>
                            </tr>
                            </tbody>
                        </table>
                    </td>
                </tr>
                </tbody>
            </table>
        </div>
    </form>
</div>
<div class="row" *ngIf="codigoContrato && totais" >
    <div class="col">
        <div class="center">
            <button class="btn waves-effect waves-light">Salvar Alterações</button>
        </div>
    </div>
</div>
